(()=>{var e={};e.id=3,e.ids=[3],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},5315:e=>{"use strict";e.exports=require("path")},7360:e=>{"use strict";e.exports=require("url")},2265:(e,t,i)=>{"use strict";i.r(t),i.d(t,{GlobalError:()=>l.a,__next_app__:()=>p,originalPathname:()=>m,pages:()=>c,routeModule:()=>u,tree:()=>o}),i(8938),i(7764),i(5866);var s=i(3191),a=i(8716),r=i(7922),l=i.n(r),n=i(5231),d={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>n[e]);i.d(t,d);let o=["",{children:["admin",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(i.bind(i,8938)),"D:\\CST-canteen-webpage\\app\\admin\\page.js"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(i.bind(i,7481))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(i.bind(i,7764)),"D:\\CST-canteen-webpage\\app\\layout.js"],"not-found":[()=>Promise.resolve().then(i.t.bind(i,5866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(i.bind(i,7481))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["D:\\CST-canteen-webpage\\app\\admin\\page.js"],m="/admin/page",p={require:i,loadChunk:()=>Promise.resolve()},u=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/admin/page",pathname:"/admin",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},90:(e,t,i)=>{Promise.resolve().then(i.bind(i,5658))},2459:()=>{},2557:(e,t,i)=>{Promise.resolve().then(i.t.bind(i,2994,23)),Promise.resolve().then(i.t.bind(i,6114,23)),Promise.resolve().then(i.t.bind(i,9727,23)),Promise.resolve().then(i.t.bind(i,9671,23)),Promise.resolve().then(i.t.bind(i,1868,23)),Promise.resolve().then(i.t.bind(i,4759,23))},5658:(e,t,i)=>{"use strict";i.d(t,{default:()=>o});var s=i(326),a=i(7577),r=i(5047),l=i(6670),n=i.n(l),d=i(622);let o=()=>{let[e,t]=(0,a.useState)("orders"),[i,l]=(0,a.useState)([]),[o,c]=(0,a.useState)([]),[m,p]=(0,a.useState)({title:"",description:"",price:"",image:"",category:"main-meals"}),[u,h]=(0,a.useState)(null),[x,g]=(0,a.useState)(!0),[b,f]=(0,a.useState)(""),[j,v]=(0,a.useState)(!1),[y,w]=(0,a.useState)("Item Added Successfully!"),N=(0,r.useRouter)(),C=[{id:"fixed-1",title:"Ema Datshi",description:"Traditional Bhutanese chili and cheese stew served with red rice",price:"Nu. 120.00",image:"https://bhutan-kitchen.com/wp-content/uploads/2024/08/Green-Chilli-Ema-Datshi-menu-item.png",category:"main-meals",isFixed:!0},{id:"fixed-2",title:"Shakam Datshi",description:"Dried beef cooked with cheese and chili",price:"Nu. 150.00",image:"https://media.sublimetrails.com/uploads/media/blog/bhutan-cuisine/shakam-shukam-datsi.png",category:"main-meals",isFixed:!0},{id:"fixed-3",title:"Kewa Datshi",description:"Potato cooked with cheese and chili",price:"Nu. 100.00",image:"https://bhutan-kitchen.com/wp-content/uploads/2024/08/Kewa-Datshi-menu-item-Bhutan-Kitchen-400x.png",category:"main-meals",isFixed:!0},{id:"fixed-4",title:"Vegetable Fried Rice",description:"Stir-fried rice with mixed vegetables and egg",price:"Nu. 110.00",image:"https://img.taste.com.au/uMAyK77R/taste/2024/08/quick-mongolian-beef-fried-rice-in-bowl-201667-1.jpg",category:"main-meals",isFixed:!0},{id:"fixed-5",title:"Cheese Sandwich",description:"Toasted bread with cheese and vegetables",price:"Nu. 80.00",image:"https://images.immediate.co.uk/production/volatile/sites/30/2024/04/HamSandwich-0d4e4ff.jpg",category:"quick-bites",isFixed:!0},{id:"fixed-6",title:"Chicken Momo",description:"Steamed dumplings filled with spiced chicken and vegetables",price:"Nu. 90.00",image:"https://img.taste.com.au/mdKxKxoR/taste/2016/11/chicken-momos-with-tomato-achar-46671-1.jpeg",category:"quick-bites",isFixed:!0},{id:"fixed-7",title:"Vegetable Spring Roll",description:"Crispy rolls filled with mixed vegetables and noodles",price:"Nu. 70.00",image:"https://www.indianhealthyrecipes.com/wp-content/uploads/2022/04/spring-rolls-with-vegetables.jpg",category:"quick-bites",isFixed:!0},{id:"fixed-8",title:"French Fries",description:"Crispy golden fries served with ketchup",price:"Nu. 60.00",image:"https://thecozycook.com/wp-content/uploads/2020/02/Copycat-McDonalds-French-Fries-.jpg",category:"quick-bites",isFixed:!0},{id:"fixed-9",title:"Suja (Butter Tea)",description:"Traditional Bhutanese salted butter tea",price:"Nu. 40.00",image:"https://blessmyfoodbypayal.com/wp-content/uploads/2024/12/IMG_6800.png",category:"beverages",isFixed:!0},{id:"fixed-10",title:"Milk Tea",description:"Traditional Bhutanese milk tea",price:"Nu. 40.00",image:"https://raw.githubusercontent.com/hdpngworld/HPW/main/uploads/65223a8acc063-Milk%20Tea%20Cup%20Top%20View.png",category:"beverages",isFixed:!0},{id:"fixed-11",title:"Lemonade",description:"Fresh squeezed lemonade with mint",price:"Nu. 50.00",image:"https://lh5.googleusercontent.com/proxy/QoPEGQzZ-HE73ZZGxnWwgKzJW6TL5Xpod2xUY3g9MbrOmWYuyeJ4UVIZq7mqpDTa676wJS7AVzLwshWnJXadVd2xnzlQGvMUjcbvscXpH30",category:"beverages",isFixed:!0},{id:"fixed-12",title:"Fresh Juice",description:"Seasonal fresh fruit juice",price:"Nu. 60.00",image:"https://www.vegrecipesofindia.com/wp-content/uploads/2021/07/fruit-juice-recipe-1.jpg",category:"beverages",isFixed:!0}];(0,a.useEffect)(()=>{"orders"===e&&k()},[e]);let k=async()=>{try{let e=await fetch("/api/fetchorder");if(!e.ok)throw Error("Failed to fetch orders");let t=await e.json();l(t),f("")}catch(e){console.error(e),f("Failed to load orders. Please try again.")}},P=async(e,t)=>{try{if(!(await fetch(`/api/order/${e}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:t})})).ok)throw Error("Failed to update status");l(i.map(i=>i.id===e?{...i,status:t}:i))}catch(e){console.error(e),f("Failed to update order status. Please try again.")}};(0,a.useEffect)(()=>{let e=localStorage.getItem("email");if(e?.toLowerCase()!=="admin@cstcanteen.com"){N.push("/");return}(async()=>{try{let[e,t]=await Promise.all([fetch("/api/menu"),fetch("/api/fetchorder")]);if(!e.ok||!t.ok)throw Error("Failed to fetch data");let i=await e.json(),s=await t.json(),a=i.slice(0,8);c([...C,...a]),l(s.map(e=>({...e,status:e.status||"Pending"}))),f("")}catch(e){f("Failed to load data. Please try again."),c(C)}finally{g(!1)}})()},[N]);let S=e=>{if(!e.title.trim())return"Title is required";if(!e.description.trim())return"Description is required";if(!e.image.trim())return"Image URL is required";if(!["main-meals","quick-bites","beverages"].includes(e.category))return"Invalid category";let t=e.price.replace(/[^0-9.]/g,"");return!t||isNaN(parseFloat(t))?"Valid price is required":null},T=async e=>{e.preventDefault();let t=S(m);if(t){f(t);return}try{let e={...m,price:m.price.replace(/[^0-9.]/g,"")},t=await fetch("/api/addmenu",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){let{error:e}=await t.json();throw Error(e||"Failed to add item")}let i=await t.json();c([...o,i]),p({title:"",description:"",price:"",image:"",category:"main-meals"}),f(""),w("Item Added Successfully!"),v(!0),setTimeout(()=>v(!1),3e3)}catch(e){f(e.message||"Failed to add item. Please try again.")}},F=async e=>{if(e.preventDefault(),String(u.id).startsWith("fixed-")){f("Cannot edit fixed menu items"),h(null);return}let t=S(u);if(t){f(t);return}try{let e={...u,price:u.price.replace(/[^0-9.]/g,"")},t=await fetch(`/api/menu/${u.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){let e=await t.json();throw Error(e.error||"Failed to update item")}let i=await t.json();c(o.map(e=>e.id===i.id?{...i,price:`Nu. ${parseFloat(i.price).toFixed(2)}`}:e)),h(null),f(""),v(!0),setTimeout(()=>v(!1),3e3)}catch(e){console.error("Edit error:",e),f(e.message||"Failed to update item. Please try again.")}},q=async e=>{if(String(e).startsWith("fixed-")){f("Cannot delete fixed menu items");return}if(confirm("Are you sure you want to delete this item?"))try{let t=await fetch(`/api/menu/${e}`,{method:"DELETE",headers:{"Content-Type":"application/json"}});if(!t.ok){let e=await t.json();throw Error(e.error||"Failed to delete item")}c(o.filter(t=>t.id!==e)),f(""),v(!0),setTimeout(()=>v(!1),3e3)}catch(e){console.error("Delete error:",e),f(e.message||"Failed to delete item. Please try again.")}};return x?s.jsx("div",{className:"min-h-screen flex items-center justify-center",children:s.jsx("i",{className:"fas fa-spinner fa-spin text-4xl text-blue-500"})}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n(),{children:[s.jsx("title",{children:"Admin Dashboard | CST Canteen"}),s.jsx("meta",{name:"viewport",content:"width=device-width, initial-scale=1.0"}),s.jsx("script",{src:"https://cdn.tailwindcss.com"})]}),(0,s.jsxs)("div",{className:"flex min-h-screen bg-gray-100",children:[j&&s.jsx("div",{className:"fixed top-4 right-4 z-50 animate-fade-in-up",children:(0,s.jsxs)("div",{className:"bg-green-500 text-white px-6 py-3 rounded-lg shadow-lg flex items-center space-x-2",children:[s.jsx(d.l_A,{className:"text-xl"}),s.jsx("span",{children:y})]})}),(0,s.jsxs)("div",{className:"w-64 bg-blue-800 text-white flex flex-col",children:[(0,s.jsxs)("div",{className:"p-4 flex items-center gap-2",children:[s.jsx("img",{src:"https://st4.depositphotos.com/16061158/39264/v/450/depositphotos_392644810-stock-illustration-food-vector-icon-food-editable.jpg",alt:"CST Canteen Logo",className:"h-10 w-10"}),s.jsx("h2",{className:"text-xl font-bold text-white",children:"CST Canteen Admin"})]}),(0,s.jsxs)("nav",{className:"flex-1",children:[(0,s.jsxs)("button",{onClick:()=>t("menu"),className:`w-full flex items-center gap-2 p-4 hover:bg-blue-700 ${"menu"===e?"bg-blue-700":""}`,children:[s.jsx(d.yQ2,{})," Menu Items"]}),(0,s.jsxs)("button",{onClick:()=>t("orders"),className:`w-full flex items-center gap-2 p-4 hover:bg-blue-700 ${"orders"===e?"bg-blue-700":""}`,children:[s.jsx(d.FeP,{})," Orders"]})]}),(0,s.jsxs)("button",{onClick:()=>{localStorage.removeItem("username"),localStorage.removeItem("email"),N.push("/login")},className:"flex items-center gap-2 p-4 hover:bg-blue-700",children:[s.jsx(d.fHX,{})," Logout"]})]}),(0,s.jsxs)("div",{className:"flex-1 p-8",children:[b&&(0,s.jsxs)("div",{className:"bg-red-500 text-white p-4 rounded mb-4",children:[b,s.jsx("button",{onClick:()=>f(""),className:"ml-4 underline",children:"Dismiss"})]}),"menu"===e&&(0,s.jsxs)("div",{children:[s.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Manage Menu Items"}),(0,s.jsxs)("form",{onSubmit:T,className:"mb-8 bg-white p-6 rounded-lg shadow",children:[s.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Add New Item"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsx("input",{type:"text",placeholder:"Title",value:m.title,onChange:e=>p({...m,title:e.target.value}),className:"border p-2 rounded",required:!0}),s.jsx("input",{type:"text",placeholder:"Description",value:m.description,onChange:e=>p({...m,description:e.target.value}),className:"border p-2 rounded",required:!0}),s.jsx("input",{type:"text",placeholder:"Price (e.g., Nu. 100)",value:m.price,onChange:e=>p({...m,price:e.target.value}),className:"border p-2 rounded",required:!0}),s.jsx("input",{type:"text",placeholder:"Image URL",value:m.image,onChange:e=>p({...m,image:e.target.value}),className:"border p-2 rounded",required:!0}),(0,s.jsxs)("select",{value:m.category,onChange:e=>p({...m,category:e.target.value}),className:"border p-2 rounded",children:[s.jsx("option",{value:"main-meals",children:"Main Meals"}),s.jsx("option",{value:"quick-bites",children:"Quick Bites"}),s.jsx("option",{value:"beverages",children:"Beverages"})]})]}),(0,s.jsxs)("button",{type:"submit",className:"mt-4 bg-blue-500 text-white p-2 rounded hover:bg-blue-600",children:[s.jsx(d.wEH,{className:"inline mr-2"})," Add Item"]})]}),u&&(0,s.jsxs)("form",{onSubmit:F,className:"mb-8 bg-white p-6 rounded-lg shadow",children:[s.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Edit Item"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[s.jsx("input",{type:"text",placeholder:"Title",value:u.title,onChange:e=>h({...u,title:e.target.value}),className:"border p-2 rounded",required:!0}),s.jsx("input",{type:"text",placeholder:"Description",value:u.description,onChange:e=>h({...u,description:e.target.value}),className:"border p-2 rounded",required:!0}),s.jsx("input",{type:"text",placeholder:"Price (e.g., Nu. 100)",value:u.price,onChange:e=>h({...u,price:e.target.value}),className:"border p-2 rounded",required:!0}),s.jsx("input",{type:"text",placeholder:"Image URL",value:u.image,onChange:e=>h({...u,image:e.target.value}),className:"border p-2 rounded",required:!0}),(0,s.jsxs)("select",{value:u.category,onChange:e=>h({...u,category:e.target.value}),className:"border p-2 rounded",children:[s.jsx("option",{value:"main-meals",children:"Main Meals"}),s.jsx("option",{value:"quick-bites",children:"Quick Bites"}),s.jsx("option",{value:"beverages",children:"Beverages"})]})]}),(0,s.jsxs)("div",{className:"mt-4 flex gap-2",children:[(0,s.jsxs)("button",{type:"submit",className:"bg-green-500 text-white p-2 rounded hover:bg-green-600",children:[s.jsx(d.fmQ,{className:"inline mr-2"})," Save Changes"]}),s.jsx("button",{type:"button",onClick:()=>h(null),className:"bg-gray-500 text-white p-2 rounded hover:bg-gray-600",children:"Cancel"})]})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow overflow-x-auto",children:[(0,s.jsxs)("div",{className:"p-4 border-b",children:[s.jsx("h3",{className:"text-lg font-semibold",children:"All Menu Items"}),(0,s.jsxs)("p",{className:"text-sm text-gray-500",children:["Total Items: ",o.length]})]}),s.jsx("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[s.jsx("thead",{className:"bg-gray-50",children:(0,s.jsxs)("tr",{children:[s.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Item"}),s.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Details"}),s.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Price"}),s.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),s.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,s.jsxs)("tbody",{className:"bg-white divide-y divide-gray-200",children:[o.map(e=>(0,s.jsxs)("tr",{className:"hover:bg-gray-50 transition-colors duration-200",children:[s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("div",{className:"flex items-center",children:s.jsx("div",{className:"h-16 w-16 flex-shrink-0",children:s.jsx("img",{src:e.image,alt:e.title,className:"h-16 w-16 rounded-lg object-cover border border-gray-200",onError:e=>{e.target.onerror=null,e.target.src="https://via.placeholder.com/64?text=No+Image"}})})})}),(0,s.jsxs)("td",{className:"px-6 py-4",children:[s.jsx("div",{className:"text-sm font-medium text-gray-900",children:e.title}),s.jsx("div",{className:"text-sm text-gray-500 line-clamp-2",children:e.description})]}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("div",{className:"text-sm font-semibold text-gray-900",children:e.price})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.jsx("span",{className:`px-2 inline-flex text-xs leading-5 font-semibold rounded-full 
                              ${"main-meals"===e.category?"bg-blue-100 text-blue-800":"quick-bites"===e.category?"bg-green-100 text-green-800":"bg-purple-100 text-purple-800"}`,children:e.category?e.category.split("-").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "):"Uncategorized"})}),s.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[s.jsx("button",{onClick:()=>{h(e)},className:"text-blue-600 hover:text-blue-900 transition-colors duration-200",title:"Edit Item",children:s.jsx(d.fmQ,{className:"w-5 h-5"})}),s.jsx("button",{onClick:()=>q(e.id),className:"text-red-600 hover:text-red-900 transition-colors duration-200",title:"Delete Item",children:s.jsx(d.Xm5,{className:"w-5 h-5"})})]})})]},e.id)),0===o.length&&s.jsx("tr",{children:s.jsx("td",{colSpan:"5",className:"px-6 py-4 text-center text-gray-500",children:"No menu items found. Add your first item using the form above."})})]})]})})]})]}),"orders"===e&&(0,s.jsxs)("div",{children:[s.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Manage Orders"}),s.jsx("div",{className:"bg-white rounded-lg shadow overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full",children:[s.jsx("thead",{children:(0,s.jsxs)("tr",{className:"bg-gray-200",children:[s.jsx("th",{className:"p-4 text-left",children:"Order ID"}),s.jsx("th",{className:"p-4 text-left",children:"Customer"}),s.jsx("th",{className:"p-4 text-left",children:"Items"}),s.jsx("th",{className:"p-4 text-left",children:"Total"}),s.jsx("th",{className:"p-4 text-left",children:"Pickup Time"}),s.jsx("th",{className:"p-4 text-left",children:"Status"})]})}),s.jsx("tbody",{children:i.map(e=>(0,s.jsxs)("tr",{className:"border-t",children:[s.jsx("td",{className:"p-4",children:e.id}),(0,s.jsxs)("td",{className:"p-4",children:[e.name," ",s.jsx("br",{}),e.email]}),s.jsx("td",{className:"p-4",children:e.items.map(e=>e.title).join(", ")}),s.jsx("td",{className:"p-4",children:e.total}),s.jsx("td",{className:"p-4",children:e.pickupTime?(()=>{let[t,i]=e.pickupTime.split(":"),s=new Date;return s.setHours(parseInt(t,10)),s.setMinutes(parseInt(i,10)),s.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0})})():"Not specified"}),s.jsx("td",{className:"p-4",children:(0,s.jsxs)("select",{value:e.status||"Pending",onChange:t=>P(e.id,t.target.value),className:`border p-2 rounded w-full ${"Completed"===e.status?"bg-green-100 text-green-800 border-green-300":"Prepared"===e.status?"bg-blue-100 text-blue-800 border-blue-300":"bg-red-100 text-red-800 border-red-300"}`,children:[s.jsx("option",{value:"Pending",children:"Pending"}),s.jsx("option",{value:"Prepared",children:"Prepared"}),s.jsx("option",{value:"Completed",children:"Completed"})]})})]},e.id))})]})})]})]})]})]})}},5047:(e,t,i)=>{"use strict";var s=i(7389);i.o(s,"useRouter")&&i.d(t,{useRouter:function(){return s.useRouter}})},8938:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>r});var s=i(9510);let a=(0,i(8570).createProxy)(String.raw`D:\CST-canteen-webpage\app\components\AdminDashboard.js#default`);function r(){return s.jsx(a,{})}},7764:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>r,metadata:()=>a});var s=i(9510);i(7272);let a={title:"CST Canteen",description:"Order food online at CST Canteen"};function r({children:e}){return(0,s.jsxs)("html",{lang:"en",children:[s.jsx("head",{children:s.jsx("link",{rel:"stylesheet",href:"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"})}),s.jsx("body",{children:e})]})}},7481:(e,t,i)=>{"use strict";i.r(t),i.d(t,{default:()=>a});var s=i(6621);let a=e=>[{type:"image/x-icon",sizes:"16x16",url:(0,s.fillMetadataSegment)(".",e.params,"favicon.ico")+""}]},7272:()=>{}};var t=require("../../webpack-runtime.js");t.C(e);var i=e=>t(t.s=e),s=t.X(0,[948,471,621,137],()=>i(2265));module.exports=s})();